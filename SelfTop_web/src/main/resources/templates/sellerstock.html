<th:block th:fragment="changetable">
        <div id="choosecontent">
            <button class="menuselect" onclick=moveorder()>íŒë§¤ë‚´ì—­ ì¡°íšŒ</button>
            <button id="stockmenu" onclick=movestock()>ì œí’ˆì¬ê³  ê´€ë¦¬</button>
        </div>
        <div class="search">
        <div class =" datesearch">
            <button id="openModalBtn" class="btn">ì œí’ˆ ë“±ë¡í•˜ê¸°</button>
        </div>
        <!-- ëª¨ë‹¬ -->
	    <div id="modal" class="modal">
	        <div class="modal-content">
	            <div class="modal-header">ìˆ˜ëŸ‰ ë° ê°€ê²© ìˆ˜ì •</div>
	            <div class="modal-body">
	                <table class="modal_table">
	                    <tr>
	                        <!--dbì—ì„œ ê°€ì ¸ì™€ select ìƒì„±í•  ì˜ˆì •-->
	                        <th>ì¹´í…Œê³ ë¦¬</th>
	                        <td>
	                            <select onchange="modelChange(this)"  name="category" id="category" size="1" required autofocus>
	                                <option value="none">ì„ íƒ</option>
	                                <option value="cpu">CPU</option>
	                                <option value="ram">RAM</option>
	                                <option value="mainboard">ë©”ì¸ë³´ë“œ</option>
	                                <option value="case">ì¼€ì´ìŠ¤</option>
	                                <option value="gpu">GPU</option>
	                                <option value="power">íŒŒì›Œ</option>
	                                <option value="ssd">SSD</option>
	                                <option value="hdd">HDD</option>
	                                <option value="cooler">ì¿¨ëŸ¬</option>
	                            </select>
	                        </td>
	                    </tr>
	                    <!--dbì—ì„œ ê°€ì ¸ì™€ select ìƒì„±í•  ì˜ˆì •-->
	                    <tr>
	                        <th>ëª¨ë¸ëª…</th>
	                        <td>
		                        <input style="width: 90%;" list="model-names" name="model-name" id="model-name-input" placeholder="ëª¨ë¸ì„ ì„ íƒí•˜ê±°ë‚˜ ê²€ìƒ‰í•˜ì„¸ìš”" autocomplete="off" class="modal_input">
		                        <datalist id="model-names"></datalist>
		                    </td>
	                    </tr>
	                    <!--dbì—ì„œ ê°€ì ¸ì™€ ì •ë³´ í‘œì‹œ ì˜ˆì •-->
	                    <tr>
	                        <th>ì œí’ˆ ì„¤ëª…</th>
	                        <td>
	                            <div class="detail">
	                                ì œí’ˆì— ëŒ€í•œ ì„¤ëª…ì…ë‹ˆë‹¤.
	                            </div>
	                        </td>
	                    </tr>
	                    <tr>
	                        
	                        <th>ì…ê³  ìˆ˜ëŸ‰</th>
	                        <td>
	                            <h4>ì…ê³  í•˜ì‹¤ ìˆ˜ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</h4>
	                            <h4 class="text-quantity"><input class="modal_input" type="number" id="quantity" name="quantity" min="1" required>  ê°œ</h4>
	                        </td>
	                        
	                    </tr>
	                    <tr>
	                        <th>íŒë§¤ ê°€ê²©</th>
	                        <td>
	                            <h4>íŒë§¤í•˜ì‹¤ ê°€ê²©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</h4>
	                            <h4 class="text-price"><input class="modal_input" type="number"  id="price" name="price" min="1" required>  ì›</h4>
	                        </td>
	                    </tr>
	                    
	                </table>
	            </div>
	            <div class="modal-footer">
	                <button id="registerModalBtn" class="btn btn-register">ë“±ë¡</button>
	                <button id="closeModalBtn" class="btn btn-close">ë‹«ê¸°</button>
	            </div>
	        </div>
    	</div>
        <script>
		     // ëª¨ë‹¬ ì œì–´ ìŠ¤í¬ë¦½íŠ¸
		   	 const modal = document.getElementById('modal');
		   	 const openModalBtn = document.getElementById('openModalBtn');
		   	 const closeModalBtn = document.getElementById('closeModalBtn');
		   	 
		   	 openModalBtn.addEventListener('click', () => {
		   	     modal.style.display = 'block';
		   	 });
		   	 
		   	 closeModalBtn.addEventListener('click', () => {
		   	     modal.style.display = 'none';
		   	 });
		   	 
		   	 // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
		   	 window.addEventListener('click', (event) => {
		   	     if (event.target === modal) {
		   	         modal.style.display = 'none';
		   	     }
		   	 });
		   	 
		   	 
		   	 // ì¹´í…Œê³ ë¦¬ ì„ íƒ ë³„ ì œí’ˆëª… ì„ íƒ
		   	const categorySelect = document.getElementById('category');
		    const modelNameInput = document.getElementById('model-name-input');

		    categorySelect.addEventListener('change', function() {
		        fetch('/seller/' + this.value + 'Products')
		            .then(response => response.json())
		            .then(data => {
		                data.sort((a, b) => a.product_name.localeCompare(b.product_name));  // ì´ë¦„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬
		                updateModelNames(data);
		            })
		            .catch(error => console.error('Error fetching ' + this.value + ' products:', error));
		    });

		    function updateModelNames(products) {
		        const modelNameDatalist = document.getElementById('model-names');
		        modelNameDatalist.innerHTML = '';  // ì´ˆê¸°í™”
		        if (products.length === 0) {
		            modelNameDatalist.innerHTML = '<option>í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ì œí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</option>';
		        } else {
		            products.forEach(product => {
		                const option = document.createElement('option');
		                option.value = product.product_name;  // ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì§€ëŠ” ì´ë¦„
		                option.setAttribute('data-product-code', product.product_code);  // ì‹¤ì œ ì œí’ˆ ì½”ë“œëŠ” ë°ì´í„° ì†ì„±ì— ì €ì¥
		                option.setAttribute('data-etc', product.etc);  // ETC ì •ë³´ë„ ì €ì¥
		                modelNameDatalist.appendChild(option);
		            });
		        }
		    }

		 	// ì œí’ˆ ëª¨ë¸ëª… ì„ íƒì‹œ ì„¤ëª… ë…¸ì¶œ
		    modelNameInput.addEventListener('input', function() {
		        const selectedOption = Array.from(document.getElementById('model-names').options).find(option => option.value === this.value);
		        const etcInfo = selectedOption ? selectedOption.getAttribute('data-etc') : 'ìƒì„¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.';
		        document.querySelector('.detail').innerHTML = `<p>${etcInfo}</p>`;  // ETC ì •ë³´ ì¶œë ¥
		    });

		    //ì œí’ˆ ëª¨ë¸ëª… ì„ íƒì‹œ ì„¤ëª… ë…¸ì¶œ
    		document.getElementById('model-name-input').addEventListener('input', function() {
			    const inputVal = this.value;
			    const options = document.querySelectorAll('#model-names option');
			    const selectedOption = Array.from(options).find(option => option.value === inputVal);
			    const productCode = selectedOption ? selectedOption.getAttribute('data-product-code') : null;
			    const etcInfo = selectedOption ? selectedOption.getAttribute('data-etc') : 'ìƒì„¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.';

			    if (productCode) {
			        document.getElementById('hidden-product-code').value = productCode;  // ì œí’ˆ ì½”ë“œë¥¼ ìˆ¨ê²¨ì§„ í•„ë“œì— ì„¤ì •
			        document.querySelector('.detail').innerHTML = `<p>${etcInfo}</p>`;  // ETC ì •ë³´ ì¶œë ¥
			    }
			});
    		
    		//ë“±ë¡ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ PRODUCT_STATUS í…Œì´ë¸”ì— PRODUCT_CODE, SELLER_NO, STOCK, PRICE, REG_DATEë¥¼ ë“±ë¡
    		 document.getElementById('registerModalBtn').addEventListener('click', function() {
		        const selectedOption = Array.from(document.getElementById('model-names').options).find(option => option.value === modelNameInput.value);
		        const productCode = selectedOption ? selectedOption.getAttribute('data-product-code') : null;

		        if (!productCode) {
		            alert('ì œí’ˆ ëª¨ë¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
		            return;
		        }
		        const quantity = document.getElementById('quantity').value;
		        if (quantity <= 0) {
		            alert('ìœ íš¨í•œ ìˆ˜ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
		            return;
		        }
		        const price = document.getElementById('price').value;
		        if (price <= 0) {
		            alert('ìœ íš¨í•œ ê°€ê²©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
		            return;
		        }

		        const data = {
		            product_code: productCode,
		            stock: quantity,
		            price: price,
		            reg_date: new Date().toISOString()
		        };

		        fetch('/seller/registerProductStatus', {
		            method: 'POST',
		            headers: {
		                'Content-Type': 'application/json',
		            },
		            body: JSON.stringify(data)
		        })
		        .then(response => {
		            if (response.ok) {
		                return response.json();
		            } else {
		                return response.text().then(text => { throw new Error(text || 'ì œí’ˆ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'); });
		            }
		        })
		        .then(result => {
		            alert('ì œí’ˆ ë“±ë¡ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
		            modal.style.display = 'none'; // ì„±ê³µ ì‹œ ëª¨ë‹¬ ì°½ ë‹«ê¸°
		            location.reload(); // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
		        })
		        .catch(error => {
		            console.error('Error:', error);
		            alert(error.message);
		        });
		    });
        </script>
        <div class="searchbox">
            <input type="text" placeholder="ê²€ìƒ‰í•  ì œí’ˆ ì…ë ¥" id="keyword">
            <button class="searchbutton" onclick=Search()>ê²€ìƒ‰</button>
            <button class="searchbutton" onclick=Reset()>ì´ˆê°€í™”</button>
        </div>

        </div>
        <div>
	<form action="/seller/changeproduct" method="post">
	        <table class ="product_table" >
	        <tr>
	            <th>ë¶„ë¥˜</th>
	            <th>ìƒí’ˆì´ë¯¸ì§€</th>
	            <th>ì œí’ˆëª…</th>
	            <th>ë³€ê²½ í›„ ê°€ê²©</th>
	            <th>ì¬ê³  ìˆ˜ëŸ‰</th>
	            <th>ìˆ˜ì •</th>
	            <th>ì‚­ì œ</th>
	        </tr>
	        <tbody id="product_view">
		        <tr th:each="dto : ${stocktable}" th:value=${dto.product_code}>
		        	<td th:text="${dto.category}"></td>
		            <td><img th:src="${dto.thumbnail}" width="50" height="50" /></td>
		            <td th:text="${dto.product_name}"></td>
					<td><input type="text" class="stockprice" th:value=${dto.price}  th:attr="data-id=${dto.product_code}" readonly>ì›</td>
					<td><input type="text" class="stockamount" th:value=${dto.stock} th:attr="data-id=${dto.product_code}" readonly>ê°œ</td>
		        	<td>
		            	<button type="submit" class="btn-update" th:attr="data-id=${dto.product_code}" title="update">âœï¸</button>
		            	<button type="submit" class="btn-save" th:attr="data-id=${dto.product_code}" title="save" style="display: none;">ğŸ’¾</button>
		            </td>
	    			<td>
				        <button type="button" class="btn-delete" th:data-product-code="${dto.product_code}" title="ì‚­ì œ">ğŸ—‘ï¸</button>
				    </td>
	            </tr>
	        </tbody>
    	</table>
    </form>
    <script>
  		//íŒë§¤ìê°€ ì•„ì´í…œì„ ì‚­ì œ í–ˆì„ë•Œ ë™ì‘í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸
	    document.querySelectorAll('.btn-delete').forEach(button => {
		    button.addEventListener('click', function(event) {
		        event.preventDefault(); // ê¸°ë³¸ ì´ë²¤íŠ¸ ë°©ì§€
		        const productCode = this.getAttribute('data-product-code'); // ë²„íŠ¼ì˜ ë°ì´í„° ì†ì„±ì—ì„œ productCode ê°€ì ¸ì˜¤ê¸°

		        if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
		            fetch(`/seller/changeproduct?productCode=${productCode}&action=delete`, {
		                method: 'POST'
		            }).then(response => {
		                if (response.ok) {
		                    return response.json();
		                } else {
		                    return response.text().then(text => { throw new Error(text || 'Failed to delete product'); });
		                }
		            }).then(result => {
		                alert(result.message); // ì„œë²„ì—ì„œ ë°˜í™˜ëœ ë©”ì‹œì§€ë¥¼ í‘œì‹œ
		                location.reload(); // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
		            }).catch(error => {
		                alert(error.message);
		            });
		        }
		    });
		});
    </script>
    </div>
</th:block>